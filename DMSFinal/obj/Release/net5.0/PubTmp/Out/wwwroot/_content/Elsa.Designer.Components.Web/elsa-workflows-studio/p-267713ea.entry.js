import{r as t,h as s}from"./p-ee0b9025.js";import{S as e}from"./p-c74b54ba.js";import{T as i}from"./p-37df3757.js";import{g as o}from"./p-15f34e27.js";import{b as n}from"./p-971980b1.js";import"./p-83f217d4.js";import"./p-4d46e1fd.js";import"./p-e0c1fede.js";import"./p-f1ec68ec.js";import"./p-a3b5bd35.js";import"./p-80de33dc.js";import"./p-93cac3a6.js";import"./p-d88cb309.js";import"./p-82db2ff5.js";import"./p-949334ec.js";let r=class{constructor(e){t(this,e),this.selectList={items:[],isFlagsEnum:!1},this.reloadSelectListFromDeps=async e=>{const t={},s=this.propertyDescriptor.options;for(const e of s.context.dependsOnValue){const s=this.activityModel.properties.find((t=>t.name==e));t[e]=s.expressions.Literal}const r=e.currentTarget;t[r.id]=r.value;let i={context:Object.assign(Object.assign({},s.context),{depValues:t}),runtimeSelectListProviderType:s.runtimeSelectListProviderType};this.selectList=await o(this.serverUrl,{options:i});let p=await n("#"+this.propertyDescriptor.name);const a=this.propertyDescriptor.defaultValue;if(a)this.currentValue=a;else{const e=this.selectList.items[0];e&&(this.currentValue="object"==typeof e?e.value:e.toString())}requestAnimationFrame((()=>{p.dispatchEvent(new Event("change"))}))}}async componentWillLoad(){var t,s;const r=this.propertyDescriptor.defaultSyntax||e.Literal;this.currentValue=this.propertyModel.expressions[r]||void 0;const i=this.propertyDescriptor.options&&"context"in this.propertyDescriptor.options?null===(s=null===(t=this.propertyDescriptor.options)||void 0===t?void 0:t.context)||void 0===s?void 0:s.dependsOnEvent:void 0;if(i){const e={};for(const t of i){for(const t of this.activityModel.properties)e[t.name]=t.expressions.Literal;const s=await n("#"+t);s.addEventListener("change",this.reloadSelectListFromDeps),e[t]=s.value}const t=this.propertyDescriptor.options,s={context:Object.assign(Object.assign({},t.context),{depValues:e}),runtimeSelectListProviderType:t.runtimeSelectListProviderType};if(this.selectList=await o(this.serverUrl,{options:s}),null==this.currentValue){const e=this.propertyDescriptor.defaultValue;if(e)this.currentValue=e;else{const e=this.selectList.items[0];e&&(this.currentValue="object"==typeof e?e.value:e.toString())}}}else if(this.selectList=await o(this.serverUrl,this.propertyDescriptor),null==this.currentValue){const e=this.propertyDescriptor.defaultValue;if(e)this.currentValue=e;else{const e=this.selectList.items[0];e&&(this.currentValue="object"==typeof e?e.value:e.toString())}}null!=this.currentValue&&(this.propertyModel.expressions[r]=this.currentValue)}onChange(t){this.propertyModel.expressions[this.propertyDescriptor.defaultSyntax||e.Literal]=this.currentValue=t.target.value}onDefaultSyntaxValueChanged(e){this.currentValue=e.detail}render(){const e=this.propertyDescriptor,t=this.propertyModel,r=e.name,i=r,o=r;let n=this.currentValue;const{items:p}=this.selectList;if(null==n){const e=this.propertyDescriptor.defaultValue;n=e?e.toString():void 0}return s("elsa-property-editor",{activityModel:this.activityModel,propertyDescriptor:e,propertyModel:t,onDefaultSyntaxValueChanged:e=>this.onDefaultSyntaxValueChanged(e),"single-line":!0},s("select",{id:i,name:o,onChange:e=>this.onChange(e),class:"elsa-mt-1 elsa-block focus:elsa-ring-blue-500 focus:elsa-border-blue-500 elsa-w-full elsa-shadow-sm sm:elsa-max-w-xs sm:elsa-text-sm elsa-border-gray-300 elsa-rounded-md"},p.map((e=>{const t="object"==typeof e,r=t?e.value:e.toString(),i=t?e.text:e.toString();return s("option",{value:r,selected:r===n},i)}))))}};i.injectProps(r,["serverUrl"]);export{r as elsa_dropdown_property};